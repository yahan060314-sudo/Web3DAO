# 交易策略优化方案 - HKU Web3 Quant Hackathon

## 📊 比赛评估标准分析

### 评分权重
- **1st Award**: Portfolio Return (最终回报)
- **2nd Award**: Risk-adjusted Return (风险调整后回报)
  - **0.4× Sortino Ratio** - 下行风险（只考虑亏损的波动）
  - **0.3× Sharpe Ratio** - 总风险（所有波动）
  - **0.3× Calmar Ratio** - 最大回撤风险

### 关键约束
- ✅ 只能现货交易，无杠杆、无做空
- ✅ 手续费 0.1%（每笔交易）
- ✅ 不能高频交易（限频保护）
- ✅ 比赛持续 2 周

## 🔍 当前策略分析

### 优点
1. ✅ 严格的风险管理（止损、止盈）
2. ✅ 仓位管理（单笔风险 ≤ 2%）
3. ✅ 冷却期机制（避免过度交易）
4. ✅ 连亏暂停机制（保护资金）

### 需要优化的点
1. ❌ **过于保守**：要求 85% 信心才开仓，可能错过机会
2. ❌ **只关注 Sharpe**：比赛评分是综合三个指标
3. ❌ **冷却期过长**：9 分钟可能太长，2 周比赛时间有限
4. ❌ **手续费考虑不足**：0.1% 手续费影响盈亏比
5. ❌ **没有明确考虑 Sortino 和 Calmar**：需要控制下行风险和回撤

## 🎯 优化策略思路

### 1. 平衡风险和收益（不过于激进）

**核心原则**：
- 信心度阈值：**70-75%**（从 85% 降低，但仍保持谨慎）
- 风险控制：保持严格的风险管理
- 机会捕捉：在合理信心下积极捕捉机会

### 2. 多指标优化（Sortino + Sharpe + Calmar）

**策略调整**：
- **Sortino Ratio**：重点控制下行风险（亏损时的波动）
  - 更严格的止损
  - 快速止损，避免大亏损
  - 盈利时让利润奔跑

- **Sharpe Ratio**：控制总波动
  - 避免频繁交易
  - 稳定的仓位管理
  - 减少不必要的交易

- **Calmar Ratio**：控制最大回撤
  - 严格的回撤控制（单日亏损 >3% 停止交易）
  - 盈利保护机制（盈利后及时止盈）
  - 分批止盈策略

### 3. 手续费优化

**考虑因素**：
- 手续费 0.1% 意味着：买入 0.1%，卖出 0.1%，总计 0.2%
- **最小盈亏比**：至少 2.5:1（考虑手续费后）
- **最小盈利目标**：至少 0.5%（覆盖手续费后仍有盈利）

### 4. 时间优化（2 周比赛）

**策略调整**：
- 冷却期：从 9 分钟降低到 **5-6 分钟**
- 决策频率：每 30 秒检查一次（不强制交易）
- 积极捕捉机会：在合理信心下（70%+）积极交易

### 5. 仓位管理优化

**策略调整**：
- 单笔风险：保持 ≤ 2%（账户净值）
- 仓位大小：根据信心度调整
  - 70-75% 信心：小额仓位（1-1.5% 风险）
  - 75-85% 信心：正常仓位（1.5-2% 风险）
  - 85%+ 信心：较大仓位（2% 风险，但不超过）

### 6. 止损止盈优化

**策略调整**：
- **止损**：1-1.5%（考虑手续费后）
- **止盈**：至少 2.5%（考虑手续费后，盈亏比 2.5:1）
- **追踪止损**：盈利 >3% 后，止损提升至成本价
- **分批止盈**：盈利 >5% 后，平 50%，余仓追踪止损

## 📝 具体优化措施

### 1. 信心度阈值调整
- **当前**：85% 信心才开仓
- **优化后**：70% 信心即可开仓，但仓位根据信心度调整

### 2. 冷却期调整
- **当前**：9 分钟
- **优化后**：5-6 分钟（平衡交易频率和风险）

### 3. 连亏暂停调整
- **当前**：连亏 2 笔→停 45 分钟
- **优化后**：连亏 2 笔→停 30 分钟（2 周比赛时间有限）

### 4. 止损止盈调整
- **当前**：止损 1-2%，止盈 ≥2%
- **优化后**：止损 1-1.5%，止盈 ≥2.5%（考虑手续费）

### 5. 多指标监控
- 添加 Sortino Ratio 监控
- 添加 Calmar Ratio 监控（最大回撤）
- 综合评估三个指标

### 6. 手续费考虑
- 所有盈亏比计算都考虑 0.2% 手续费（买入+卖出）
- 最小盈利目标：0.5%（覆盖手续费后）

## 🚀 实施计划

### 阶段1：Prompt 优化
1. 修改信心度阈值（85% → 70-75%）
2. 调整冷却期（9 分钟 → 5-6 分钟）
3. 优化止损止盈策略（考虑手续费）
4. 添加多指标优化指导

### 阶段2：策略逻辑优化
1. 添加 Sortino Ratio 计算和监控
2. 添加 Calmar Ratio 计算和监控
3. 优化仓位管理（根据信心度调整）
4. 优化手续费考虑

### 阶段3：测试和调整
1. 回测优化后的策略
2. 调整参数（信心度、冷却期等）
3. 优化多指标平衡

## 📊 预期效果

### 优化前
- 过于保守，可能错过机会
- 只关注 Sharpe Ratio
- 交易频率可能过低

### 优化后
- 平衡风险和收益
- 综合考虑三个指标
- 在合理风险下积极捕捉机会
- 更好的风险调整后回报

## ⚠️ 风险控制

尽管优化策略，但仍保持严格的风险控制：

1. **单笔风险**：≤ 2%（账户净值）
2. **单日亏损**：>3% 停止交易
3. **连亏暂停**：连亏 2 笔→停 30 分钟
4. **最大回撤**：>5% 停止交易
5. **止损**：每笔交易都有止损
6. **止盈**：合理的止盈目标

## 🎯 总结

优化策略的核心是：
1. **不过于激进**：保持严格的风险控制
2. **不过于保守**：在合理信心下积极捕捉机会
3. **多指标优化**：综合考虑 Sortino、Sharpe、Calmar
4. **手续费优化**：所有决策考虑 0.1% 手续费
5. **时间优化**：2 周比赛时间，平衡交易频率和风险

这样的策略可以在保持风险控制的同时，最大化风险调整后回报，从而在比赛中获得更好的成绩。

